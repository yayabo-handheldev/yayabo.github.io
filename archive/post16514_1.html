
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>[手册]RMDS API手册</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    </head>

    <body style="margin-top:1.618%">
        <div class="container">
            <div class="row">
                <div class="jumbotron">
                    <h1 class="display-5">[手册]RMDS API手册</h1>
                </div>
                <br />
                <nav class="nav">
                    <a class="nav-link active" aria-current="page" href="index_17.html">返回</a>
                </nav>
            </div>

            <hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>雷精灵</b><br/>
2009-08-16 16:11:19</p>
</div>
<div class="col-10">
<p>[b]ExecuteScript(脚本路径及名称)[/b]<br />执行参数指定的脚本。<br />例如：ExecuteScript("/world/TalkWithHama.lua")<br />这句话的意思就是执行/world/TalkWithHama.lua这个脚本。<br />注意，有些函数自带执行脚本功能，因此这个函数很少用到。一般情况下只有在当一个脚本非常长的时候才需要这个函数。将脚本截成若干个脚本，然后使用该函数将脚本们连接起来。<br />这个函数可以用于任何模块。<br /><br />[b]SwitchModule(模块名称,启动脚本)[/b]<br />引擎切换到指定模块，然后立刻执行指定的启动脚本。<br />例如：SwitchModule(MODULE_WORLD,"/world/worldStartup.lua")<br />这句话的意思就是把引擎切换到世界模块，然后执行/world/worldStartup.lua这个脚本。<br />注意，参数只能取如下常量值：<br />MODULE_NULL，这是一个不存在的模块，游戏永远不会用到这个模块，你也绝不要切换到这个模块；<br />MODULE_LOGO，Logo模块；<br />MODULE_MENU，菜单模块；<br />MODULE_WORLD，世界模块；<br />MODULE_BATTLE，战斗模块；<br />MODULE_SHOP，商会模块（当前版本的引擎尚未支持该模块）；<br />MODULE_OTHER，其他模块（当前版本的引擎尚未支持该模块）。<br />进入指定模块后，引擎将会立刻执行指定的启动脚本。因此你可以在启动脚本中进行一些初始化。比如进入世界模块后，首先定义几个以后可能用得到的全局变量之类的……<br />这个函数可以用于任何模块。<br /><br />[b]DisplayImage(图片资源名,屏幕ID,x坐标,y坐标,是否居中显示)[/b]<br />在指定的屏幕上指定的坐标位置显示出指定的图片。<br />如果屏幕ID>0则图片显示在上屏，如果屏幕ID<0则图片显示在下屏，如果屏幕ID=0则两个屏都显示。<br />如果最后一个参数=true则图片必定居中显示。此时x和y坐标两个参数会被忽略。<br />例如：DisplayImage("/logo/logo0.bin",1,0,0,true)<br />这句话的意思就是在上屏居中显示/logo/logo0.bin这张图。<br />注意，这个函数显示的图片是.bin格式。“生成Logo图片”这个工具可以将.bmp转成.bin。关于这个工具的使用方法，请点击这里。<br />注意，由于DS的屏幕为256*192，因此图片的大小不能大于这个范围。此外，x和y坐标这两个参数，也必须处于屏幕范围之内，不得让图片超过屏幕显示区域，否则你会很郁闷地发现图片从另一边卷出来了……<br />这个函数只能用于Logo模块和菜单模块。<br /><br />[b]ClearScreen(屏幕ID)[/b]<br />清除指定屏幕。执行完这个函数之后指定的屏幕会被全部涂黑。<br />如果屏幕ID>0则清除上屏，如果屏幕ID<0则清除下屏，如果屏幕ID=0则两个屏都清除。<br />这个函数只能用于Logo模块和菜单模块。<br /><br />[b]FadeFX(屏幕ID,初始亮度,终止亮度,速度)[/b]<br />亮度特效。指定屏幕会立刻变成初始值，然后逐渐变成终止值。<br />如果屏幕ID>0则上屏进行亮度特效，如果屏幕ID<0则图片下屏进行亮度特效，如果屏幕ID=0则两个屏都进行亮度特效。<br />初始亮度和终止亮度范围为-16~+16。-16=最暗；+16=最亮；0=正常。<br />速度值越大，变化越缓慢。60代表1秒改变1级亮度；<=0则代表瞬间变成终止亮度。<br />注意，该函数为“持久性”函数。它会阻塞脚本的执行，直到这个函数执行完为止。<br />这个函数可以用于任何模块。<br /><br />[b]CreateMenuItem(图标ID,菜单文字,x坐标,y坐标,hx坐标,hy坐标,hw,hh)[/b]<br />这个函数将会在下屏创建出一个菜单项。菜单项的文字为指定文字，图标为指定ID的图标，菜单的坐标位置为(x,y)，菜单的热点区域为(hx,hy,hw,hh)。<br />例如：CreateMenuItem(0,"新游戏",128,48,0,0,256,96)<br />这句话的意思就是，创建一个菜单项，菜单项的说明文字是“新游戏”，图标为menuIcon.bin这个资源文件中第0号图标，图标的位置为(128,48)，当点击了(0,0,256,96)这个范围也就是下屏的上半部分的时候，被视为触发该菜单。<br />注意，几个坐标参数不得超过屏幕范围。<br />这个函数只能用于菜单模块。<br /><br />[b]GetSelectedMenu()[/b]<br />这个函数将会返回玩家点中的菜单项。<br />例如：local selectedMenu=GetSelectedMenu()<br />这句话的意思就是，获得玩家选中的菜单，然后赋值给局部变量selectedMenu。<br />注意，这个函数是“持久性”函数。如果玩家没有点击触屏，或者点击触屏的区域不在任何菜单项的热点区域，那么脚本将一直停留在这里，不会往下执行。也就是说，“等待你做出选择”。直到你点中了某个菜单项的热点区域，或者更直观地说，“触发”了该菜单项，此时该函数才会返回那个被触发的菜单项的ID。此时你就可以根据返回值进行判断，从而进入不同的剧情或者模块……<br />这个函数只能用于菜单模块。<br /><br />[b]CreateScene(场景路径及名称,切屏特效方式)[/b]<br />创建指定场景。在创建场景的时候使用指定切屏特效方式。<br />切屏特效方式目前只有6种：<br />0=栅栏；<br />1=百叶窗；<br />2=圆；<br />3=随机线；<br />4=水平屏风；<br />5=垂直屏风。<br />如果切屏特效方式<0则随机从以上几种方式中选择一种。<br />例如：CreateScene("/intro/Mercury.lua",-1)<br />这句话的意思就是，创建/intro/Mercury.lua这个场景。在创建场景的时候随机使用一种切屏特效方式。<br />这个函数只能用于世界模块。<br /><br />[b]KillScene()[/b]<br />杀掉当前场景。<br />这个函数没什么好解释的。<br />这个函数只能用于世界模块。<br /><br />[b]SetWeatherFX(天气特效类型)[/b]<br />设置天气特效。<br />例如：SetWeatherFX(WEATHERFX_SNOW)<br />这句话的意思就是，设置当前场景的天气特效为下雪。<br />注意，参数只能取如下常量值：<br />WEATHERFX_NONE，正常天气；<br />WEATHERFX_RAIN，下雨；<br />WEATHERFX_THUNDERSTORM，下雨+电闪雷鸣；<br />WEATHERFX_SNOW，下雪；<br />WEATHERFX_FOG，雾；<br />WEATHERFX_SUNBURN，烈日炎炎（当前版本的引擎尚未支持该天气特效）。<br />这个函数只能用于世界模块。<br /><br />[b]CreateMap(地图路径和名称)[/b]<br />创建地图。<br />例如：CreateMap("/world/Hama'sRoom.pak")<br />这句话的意思就是，创建/world/Hama'sRoom.pak这个地图并显示在屏幕上。<br />注意，这个函数创建的地图是.pak格式。.pak格式的地图很难制作，点击这里查看详细制作方法。<br />这个函数只能用于世界模块。<br /><br />[b]KillMap()[/b]<br />杀掉当前地图。<br />这个函数没什么好解释的。<br />注意，创建新地图之前请一定要杀掉以前的地图。<br />这个函数只能用于世界模块。<br /><br />[b]SetCameraXY(x坐标,y坐标)[/b]<br />设置摄像机窗口在世界坐标系中的坐标。<br />例如：SetCameraXY(120,168)<br />这句话的意思就是，摄像机镜头在世界的(120,168)坐标处。<br />注意，这个坐标值，指的是摄像机镜头的左上角的坐标。<br />这个函数只能用于世界模块。<br /><br />[b]SetCameraFollow(摄像机跟随的NPC)[/b]<br />设置摄像机跟随的NPC。<br />例如：SetCameraFollow(0)<br />这句话的意思就是，摄像机镜头跟随0号NPC移动。0号NPC跑到哪，摄像机镜头跟到哪。<br />注意，参数必须是已经存在的NPC。否则摄像机镜头可能会跑到不知什么地方……<br />如果参数<0，则摄像机不跟随任何NPC。<br />这个函数只能用于世界模块。<br /><br />[b]CreateNPC(NPCID,NPC资源路径和名称)[/b]<br />创建NPC。<br />例如：CreateNPC(0,"/world/Isaac.pak")<br />这句话的意思就是，创建0号NPC，这个NPC使用的资源为/world/Isaac.pak。<br />执行完这个函数之后，NPC就被创建出来，并且占用指定的ID。<br />注意，创建NPC的时候必须保证它所使用的NPCID未被占用。否则创建NPC必定会失败。<br />NPC资源是.pak格式。“精灵编辑器”可以创建这种格式的资源。点击这里查看详细的制作方法。<br />注意，正常情况下每个场景中最多只能创建16个NPC。或者说，NPCID最大只能=15。但是，使用某种邪恶的技巧，可以实现每个场景中最多32个NPC。详细的方法点击这里查看。<br />这个函数只能用于世界模块。<br /><br />[b]KillNPC(NPCID)[/b]<br />杀掉指定ID的NPC。<br />例如：KillNPC(0)<br />这句话的意思就是，杀掉第0号NPC。<br />注意，必须是已经被创建出来的NPC才能被杀掉。如果杀掉一个不存在的NPC，则会出现极严重的问题。<br />NPC被杀掉之后，它所占用的NPCID也就被释放了，以后就可以重复利用这个ID创建新的NPC了。<br />这个函数只能用于世界模块。<br /><br />[b]EnableNPCCld(NPCID,是否激活判定框)[/b]<br />设置是否激活指定NPC的判定框。<br />例如：EnableNPCCld(0,false)<br />这句话的意思就是，禁用0号NPC的判定框。此时该NPC不会和世界发生碰撞，可以穿墙和其他NPC。<br />默认情况下，CreateNPC()创建出来的NPC，都是已经激活了判定框的。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCXY(NPCID,x坐标,y坐标)[/b]<br />设置指定NPC在世界坐标系中的坐标。<br />例如：SetNPCXY(0,120,256)<br />这句话的意思就是，把第0号NPC移动到世界坐标系的(120,256)处。<br />注意，这个函数是“瞬移”。不要以为NPC会老老实实地从当前坐标点“走”到那个目标坐标点。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCScreenPos(NPCID,x坐标,y坐标)[/b]<br />设置指定NPC在屏幕坐标系中的坐标。<br />例如：SetNPCScreenPos(1,128,96)<br />这句话的意思就是，把第1号NPC移动到屏幕的中央。<br />注意，由于摄像机窗口的大小就是屏幕大小，因此这个函数也可以理解为摄像机坐标系。<br />但是，这个时候就出现一个问题：如果摄像机跟随这个NPC，那么NPC一旦移动，摄像机也跟着移动，于是摄像机坐标系也随之移动……结果就像追月亮似的永远追不上……<br />所以，这个函数决不能用到被摄像机跟随的NPC身上。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCPrio(NPCID,层ID)[/b]<br />设置NPC所在层。<br />例如：SetNPCPrio(0,2)<br />这句话的意思就是，设置0号NPC处于前景层。<br />注意，由于世界只有4层，分别是UI层（0），特效层（1），前景层（2）和背景层（3），因此层ID参数只能取0~3这4个值。<br />这个函数很少用到，一般用于做一些非常特殊的“特效NPC”。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCSFX(NPCID,NPC特效类型)[/b]<br />设置NPC特效类型。<br />例如：SetNPCSFX(0,NPCSFX_BLENDING)<br />这句话的意思就是，设置0号NPC为半透明混合NPC。<br />注意：NPC特效类型只能取如下常数值：<br />NPCSFX_NORMAL，不使用特效；<br />NPCSFX_BLENDING，半透明混合特效；<br />NPCSFX_WINDOWED，窗口挖空特效；<br />NPCSFX_BITMAP，这个值虽然可以取，但却是一种非法的特效，请一定不要使用这个值。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCDirection(NPCID,方向)[/b]<br />设置NPC面向。<br />例如：SetNPCDirection(0,DIR_UP)<br />这句话的意思就是，设置0号NPC面向北。<br />注意，方向参数只能取如下常数值：<br />DIR_NULL，这是一种非法的方向，被称为“未定义方向”。请一定不要使用这个值；<br />DIR_UP，向北（上）；<br />DIR_DOWN，向南（下）；<br />DIR_LEFT，向西（左）；<br />DIR_RIGHT，向东（右）。<br />除此之外，斜方向可以使用任意两个合法的方向相加获得。例如向西北（左上）就可以写作DIR_UP+DIR_LEFT。<br />但是，三者甚至四者相加则是不允许的。因为根本不存在例如“东西北”这样的方向……<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCStatus(NPCID,状态)[/b]<br />设置NPC当前状态。<br />例如：SetNPCStatus(0,STA_WALK)<br />这句话的意思就是，设置0号NPC为“走”的状态。<br />注意，状态只能取如下常数值：<br />STA_IDLE，静止状态。此时NPC播放“IDLE”动画序列；<br />STA_WALK，行走状态。此时NPC播放“WALK”动画序列；<br />STA_RUN，跑步状态。此时NPC播放“RUN”动画序列；<br />STA_E0，附加状态0。此时NPC播放“E0”动画序列；<br />STA_E1，附加状态1。此时NPC播放“E1”动画序列；<br />STA_E2，附加状态2。此时NPC播放“E2”动画序列；<br />STA_E3，附加状态3。此时NPC播放“E3”动画序列。<br />其实，这个函数主要是用来设置“NPC播放什么动画序列”的。设置为“STA_WALK”，NPC并不会真正“走”起来，还需要设置NPC的面向、移动速度等参数值，才能真正让NPC走起来。同理，设置为STA_IDLE也不会让移动的NPC停下来，只不过会使NPC播放“IDLE”动画序列而已，NPC该怎么走还怎么走。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCAction(NPCID,行为类型)[/b]<br />设置NPC行为。<br />例如：SetNPCAction(0,ACT_PLAYERCONTROL)<br />这句话的意思就是，0号NPC成为主角，受到玩家的控制与操纵。<br />注意，行为类型只能取如下常数值：<br />ACT_PLAYERCONTROL，玩家控制。此时的NPC成为主角，玩家用方向键可以控制该NPC的行走；<br />ACT_STAYSTILL，站着不动。此时NPC会一动不动地站着，连当前的动画序列也不会播放，直接停在第0帧。看起来就像一尊雕像一样。一般用于“尸体”或者是某些场景NPC。<br />ACT_STANDRANDOM，随机面向。此时NPC虽然也是站着不动，但是会随机转向某个方向，看起来就像是四处乱瞅一样。一般用于“等待生意的站街女”、“卖黄碟的猥琐汉”、“迷路的小孩”等。<br />ACT_WALKAROUND，四处散步。此时NPC会随机向某个方向走动，看起来就像是在散步一样。一般的NPC都可以使用这个行为。<br />ACT_SCRIPTCONTROL，脚本控制。此时NPC会也会站着不动，但不会像ACT_STAYSTILL连动画都不播放那么死板，也不会像ACT_STANDRANDOM那样随机面向，而是一直面向某个方向，同时播放该方向上的IDLE动画序列。一般用于“商会的老板”和场景NPC。此外，这种行为类型可以接受脚本控制。<br />注意，这个函数会强制Override NPC的移动速度。也就是说，如果你设置NPC为ACT_WALKAROUND行为，又设置NPC移动速度为“跑”，那么NPC并不会以“跑”的速度四处散步，而是照样“走着散步”。设置的NPC移动速度被Override掉了。<br />这个函数只能用于世界模块。<br /><br />[b]SetNPCMoveSpeed(NPCID,速度值)[/b]<br />设置NPC的移动速度。<br />注意，速度值的范围为-32767~+32767。但是，绝大多数数值都是无意义的，只有极少几个值有意义。<br />其中，-1=走的速度；1=跑的速度；0=介于走和跑之间的速度。值越大移动速度越快。<br />例如：SetNPCMoveSpeed(0,-1)<br />这句话的意思就是令0号NPC以“走”的速度移动。<br />注意，如果值太小，比如-100甚至更小，则NPC相当于完全静止。所以如果希望令某个NPC停止移动，可以将其速度设置为-32767或者随便一个极小的负数。<br />注意，如果值太大，比如50甚至更大，此时NPC的移动速度会快到根本看不见。此时由于速度太快，以至于甚至可以直接穿墙从而跑到地图外面。这是不允许的行为。因此要求值不得过大。<br />注意，这个函数才是决定NPC移动的关键。哪怕你SetNPCStatus(0,STA_WALK)，只要这里设置0号NPC的速度为静止，那么0号NPC照样无法移动，只能原地踏步……同理，哪怕你SetNPCStatus(0,STA_IDLE)，只要0号NPC的速度能够令他移动，那么0号NPC就会像鬼一样不迈腿就飘走了……<br />这个函数只能用于世界模块。<br /><br />[b]MoveNPC(NPCID,目的x坐标,目的y坐标,移动状态)[/b]<br />移动指定NPC到指定坐标点，并且返回线程ID。<br />这是一个非常邪恶的函数。<br />注意，目的坐标为世界坐标系。<br />注意，移动状态只能取如下常数值：<br />STA_IDLE，静止状态。此时NPC播放“IDLE”动画序列；<br />STA_WALK，行走状态。此时NPC播放“WALK”动画序列；<br />STA_RUN，跑步状态。此时NPC播放“RUN”动画序列；<br />STA_E0，附加状态0。此时NPC播放“E0”动画序列；<br />STA_E1，附加状态1。此时NPC播放“E1”动画序列；<br />STA_E2，附加状态2。此时NPC播放“E2”动画序列；<br />STA_E3，附加状态3。此时NPC播放“E3”动画序列。<br />这个参数表示，在NPC的移动过程中，NPC播放哪组动画序列。<br />例如：local tID=MoveNPC(0,128,256,STA_RUN)<br />这句话的意思就是，0号NPC从当前坐标点，以“跑步”的姿态直线移动到(128,256)坐标点。到达目的地之后停止“跑步”姿态，同时停止移动。这个函数创建的线程，被赋值给局部变量tID。<br />注意，单独使用这个函数并不能令NPC移动，千万不要忘了设置NPC的移动速度，才能真正令其“移动”起来。<br />注意，这个函数是“线程函数”。执行这个函数的时候，会创建出一个独立的线程。线程的ID会被返回出来。该NPC会在这个线程中移动，脚本不会停在这里等NPC走完，而是继续往下执行。当NPC移动到目标坐标点之后，NPC停止移动，动画序列也转向IDLE动画，然后它所创建的线程会自动销毁。这个函数之所以会这样做，主要是为了解决“跟随”问题。比如令0号NPC移动到某坐标，令1号NPC移动到另一坐标，则两个NPC各走各的，不会出现必须等0号走完了1号才能走的现象。<br />当然，有的时候需要等NPC走完，才允许脚本继续往下执行，这个时候配合另一条脚本WaitForThreadDie，就可以实现了。<br />注意，这个函数不能寻路。换句话说，NPC会一条直线地往目的地走，不会绕路。所以如果路上有障碍物比如墙壁或者别的NPC，只要这个NPC的判定框是激活状态，那么该NPC就会被挡住走不过去。但NPC不知道自己被挡住了，还是傻傻地往前走……遇到这个问题没办法，只能靠你预先给他指条道路……<br />注意，NPC并非会精确地停在目标坐标点，而是大约会有2~3个像素的误差。所以在游戏中这个坐标点需要调试。<br />这个函数只能用于世界模块。<br /><br />[b]ShowBubble(NPCID,x坐标,y坐标,表情气泡ID)[/b]<br />在指定NPC的头上显示出表情气泡，并且返回线程ID。<br />例如：local tID=ShowBubble(0,0,0,1)<br />这句话的意思就是，在0号NPC的脑袋上显示出第1号表情气泡。<br />注意，NPCID参数必须为已经存在的NPC，否则表情气泡会不知道被显示到什么地方去……<br />注意，如果NPCID<0，则表情气泡不会出现在任何NPC脑袋上，而是由x和y两个参数指定显示的坐标。这个坐标是屏幕坐标系，因此超过屏幕范围也将看不到表情气泡。如果NPCID是一个合法的NPCID，则表情气泡会显示在该NPC的脑袋上，x和y参数会被无视掉。<br />注意，如果表情气泡ID参数的值大于bubble.bin这个表情气泡资源中已有的表情气泡数量，则可能会显示出一个混乱的表情气泡。<br />注意，这个函数是“线程函数”。它会创建出一个新的线程，并将线程ID返回出来。在这个线程中气泡会被显示出来，然后等待几秒自动消失，线程也随之自动销毁。在这个过程中脚本不会停下等待显示完气泡，而是继续向下执行。这个函数之所以要这样做，主要是为了解决“多个NPC同时显示表情气泡”的问题。NPC们会各自在自己的脑袋上显示各自的表情气泡，不会排着队等上一个NPC的显示完了才显示下一个NPC的。<br />当然，有时候需要等待表情气泡显示完，才允许脚本继续往下执行，这个时候配合另一条脚本WaitForThreadDie，就可以实现了。<br />这个函数只能用于世界模块。<br /><br />[b]CreateTrigger(触发器ID,触发器关联的NPCID,触发器x坐标,触发器y坐标,触发器宽,触发器高,触发类型,触发器关联脚本的名称)[/b]<br />创建触发器。<br />触发器是一个矩形区域。当这个矩形区域被“触发”之后，会执行指定的脚本。<br />例如：CreateTrigger(0,1,-9,-17,18,18,TRIGGER_EVENT,"/world/TalkWithHama.lua");<br />这句话的意思就是，创建一个触发器，该触发器的ID为0，关联到第1号NPC上，触发器的大小为18*18像素，相对于1号NPC的中心点，偏移(-9,-17)，触发类型为事件触发，触发后执行/world/TalkWithHama.lua这个脚本。<br />在同一个场景中，可以创建无穷多个触发器。引擎通过触发器ID参数来标识并访问这些触发器。<br />触发器可以绑定到某个NPC身上。这个过程叫做“关联”。当触发器被关联到NPC身上之后，NPC移动到什么地方，触发器也跟着移动到什么地方，正如“绑定”这个词描述的一样。<br />注意：触发器关联的NPC ID，必须是一个已经存在的NPC。如果关联的NPC不存在，则这个触发器不知道会跑到什么地方……<br />注意：触发器关联的NPC ID这个参数，可以取负值。此时引擎认为该触发器没有关联任何NPC，而是独立地出现在场景中。此时这个触发器被称为“独立触发器”。<br />触发器的坐标和宽高可以通过后面几个参数设定。<br />注意：如果该触发器为独立触发器，则后面几个参数代表触发器在世界坐标系下的坐标和宽高；如果该触发器关联到了NPC身上，则触发器x坐标和触发器y坐标这两个参数表示该触发器的左上角相对于它的“寄主”中心点的坐标偏移量，而触发器宽高这两个参数依然表示触发器宽高。<br />注意：触发类型参数只能取如下常数值：<br />TRIGGER_DEFAULT，默认触发。使用这种类型的触发器无论如何都不会被触发。所以一般情况下仅用于调试，游戏中从不会用到这种触发类型。<br />TRIGGER_EVENT，事件触发。使用这种类型的触发器，当玩家操纵的那个角色碰到了该触发器，并且此时玩家按下A键时被触发。一般用于普通NPC。比如给NPC关联上这种触发类型的触发器，当玩家操纵的角色碰到该NPC并且玩家按下A键，则可以实现“对话”。<br />TRIGGER_STEP，踏入触发。使用这种类型的触发器，只要NPC，包括玩家操纵的角色，踩到了这个触发器，就会触发。一般用于场景转移和踩地雷。比如在地图的房子门口放置一个使用这种触发类型的独立触发器，则只要角色踩到这个触发器，就“切换场景”到房间内。<br />TRIGGER_AUTO，自动触发。使用这种类型的触发器，不需要任何条件，会立刻被触发。这种类型的触发器很令人头疼，因为它不需要任何条件，所以一旦该触发器被创建出来之后就立刻被触发。触发完之后，如果该触发器没有被删除，则还会被触发。然后一直循环……所以一般情况下要在它关联的脚本中加入条件判断，只有满足了条件之后才执行脚本内容，否则直接跳出脚本。<br />注意：由于频繁解析脚本的缘故，使用触发类型为TRIGGER_STEP和TRIGGER_AUTO的触发器会稍微影响游戏的速度。所以请尽量少用这两种类型的触发器。尤其是TRIGGER_AUTO这种触发器，尽可能少用。当然，不是绝对禁止使用，尽量少用。<br />注意，如果同时满足多个触发条件——比如场景中有两个触发器，一个是TRIGGER_EVENT触发器，另一个是TRIGGER_AUTO触发器。根据上述触发条件的解释，自动触发始终被触发，如果此时主角碰到了某NPC并企图和他对话，则又触发了该事件触发。在这一瞬间，两个触发器，到底执行哪个触发器关联的脚本呢？——谁的“触发器ID”参数小，就执行谁。那么，执行完了呢？——执行完了就完了，另一个触发器也不会被执行了。也就是说，当同时触发了多个触发器，则谁的触发器ID小，就触发谁。剩下的触发器都不会被触发，就像那些触发器完全不存在一样。<br />注意：主角绝不要关联触发器！<br />这个函数只能用于世界模块。<br /><br />[b]KillTrigger(触发器ID)[/b]<br />杀掉指定的触发器。<br />这个函数无需多解释。<br />注意，必须是已经被创建出来的触发器才能杀。千万不要杀不存在的触发器。<br />这个函数只能用于世界模块。<br /><br />[b]KillTriggerAll()[/b]<br />杀掉当前场景中所有的触发器。<br />这个函数无需多解释。<br />这个函数只能用于世界模块。<br /><br />[b]HookNPC()[/b]<br />勾住被触发的NPC。<br />这个函数比较怪异，它的适用范围很窄，但经常能被用到。<br />它只用于这种情况：主角和某NPC交谈。<br />如果NPC的触发脚本中加入这个函数，则NPC会停下手里干的事，自动面向主角；主角也停止移动，面向NPC。<br />比如通过SetNPCAction设置NPC的行为为ACT_WALKAROUND，则该NPC会四处走动散步。如果主角和他对话，则该NPC应该停止散步，面向主角；主角停止移动，面向NPC。对话完之后NPC继续散步，主角继续被玩家控制。<br />所以这种情况下要求在该NPC绑定的触发器关联的脚本的第一行加入这个函数。<br />这个函数只能用于世界模块。<br /><br />[b]UnhookNPC()[/b]<br />释放被勾住的NPC。<br />和上面那个函数相对应。<br />所以要求那个NPC的触发器的关联脚本的最后一句话加入这个函数。<br />这个函数只能用于世界模块。<br /><br />[b]DisplayDialog(NPC ID,对话框x坐标,对话框y坐标,文本字符串)[/b]<br />显示对话文本。<br />嘿嘿，这是最常用的函数！<br />例如：DisplayDialog(0,0,0,"#a00#s2#v07#c3阿历克斯#c1？#n阿历克斯不是死了么？")<br />这句话的意思就是，在第0号NPC的脑袋上显示对话框，对话框的内容像这样：<br />[效果][color=Lime]阿历克斯[/color]？<br />阿历克斯不是死了么？[/效果]<br />此外，对话框旁边显示第00号头像，对话文本以2级速度逐字显示，每显示一个字都播放第07号音效。<br />注意：NPC ID参数决定对话框显示在哪个NPC的脑袋上。因此要求该参数必须为一个有效的NPC ID。此时后面两个坐标参数被无视。<br />NPC ID可以取负值，此时表示对话框显示的坐标由后两个坐标决定。<br />注意：文本字符串支持转义字符。<br />转义字符由“#”引导，后面跟随1个字母表示转义类型，再跟随0~4个[color=Red]十六进制数字[/color]表示参数。<br />目前引擎支持如下转义字符：<br />#n。换行。无参数。<br />#a??。显示头像。2位参数。此时会在对话框周围显示出avatar.bin资源中指定ID的头像。注意不要超过avatar.bin中资源的数量，否则会显示出一个混乱的头像。<br />#s?。改变文字显示速度。1位参数。在这个转义符后面的所有文字，都会改变成参数指定的速度显示。其中，0代表最快，后面的字符会瞬间显示出来。数值越大，显示越慢。F代表最慢。<br />#v??。改变文字显示音效。2位参数。在这个转义符后面的文字，在显示的时候会播放指定ID的音效。如果设置成00则代表无声。<br />#c?。改变文字显示颜色。1位参数。在这个转义符后面的文字，在显示的时候会改成指定的颜色。其中，0=黑色，1=白色，2=[color=Red]红[/color]色，3=[color=Lime]绿[/color]色，4=[color=Blue]蓝[/color]色，5=[color=Yellow]黄[/color]色，6=[color=Magenta]粉[/color]色，7=[color=Cyan]青[/color]色，8~15=黑色。<br />#z。一切恢复正常。无参数。在这个转义符后面的文字，速度=1，颜色=1，头像=00，音效=00。<br />注意：这个函数不会阻塞线程。也就是说，这个函数后面必须要跟随一个“等待”函数，才能正常工作。一般情况下是跟随WaitForKey(KEY_A)，即等待A键按下。如果不跟随等待函数的话，脚本会继续往下执行。<br />这个函数只能用于世界模块。<br /><br />[b]EnableSFX(目标1,目标2,特效类型)[/b]<br />激活特效。<br />例如：EnableSFX(BLEND_BG2,BLEND_BG0+BLEND_BG1+BLEND_BG3+BLEND_OBJ+BLEND_BACKDROP,SFX_BLENDING)<br />这句话的意思就是，特效层相对于背景、前景、精灵和背后幕布做半透明混合特效。<br />注意：这个函数只能这样设定。其他一切参数设定都是非法的。<br />这个函数只能用于世界模块。<br /><br />[b]DisableSFX()[/b]<br />禁用特效。<br />这个函数没有什么好解释的。<br />这个函数只能用于世界模块。<br /><br />[b]AlphaBlending(被混合层的深度,混合层的深度)[/b]<br />设置半透明混合的参数值。<br />例如：AlphaBlending(16,16)<br />这句话的意思就是，令特效层完全与其它层混合。<br />注意，这个函数只有在“激活特效”之后才有效。<br />注意，两个参数的范围为0~16。具体效果你可以自己尝试。<br />这个函数可以用于任何模块。<br /><br />[b]SetBGColorSFX(颜色特效类型)[/b]<br />设置背景和前景的颜色特效。<br />这个函数很少用到。<br />例如：SetBGColorSFX(1)<br />这句话的意思就是，令背景和前景灰化。<br />注意，参数只能取以下常数值：<br />0，恢复上一个特效。<br />1，灰化。<br />2，白化。<br />3，黑化。<br />4，红化。<br />5，金化。<br />这个函数很不稳定，将来的版本很有可能取消这个函数。<br />这个函数只能用于世界模块。<br /><br />[b]WaitForVBL(帧数)[/b]<br />等待指定帧。<br />例如：WaitForVBL(60)<br />这句话的意思就是等待1秒钟。<br />注意，60帧=1秒。<br />这个函数可以用于任何模块。<br /><br />[b]WaitForKey(键值)[/b]<br />等待指定键按下。<br />例如：WaitForKey(KEY_A)<br />这句话的意思就是，等待A键按下。<br />注意，参数只能取如下常数值：<br />KEY_A，A键。<br />KEY_B，B键。<br />KEY_SELECT，选择键。<br />KEY_START，开始键。<br />KEY_RIGHT，右方向键。<br />KEY_LEFT，左方向键。<br />KEY_UP，上方向键。<br />KEY_DOWN，下方向键。<br />KEY_R，R键。<br />KEY_L，L键。<br />KEY_X，X键。<br />KEY_Y，Y键。<br />KEY_TOUCH，触屏被点下。<br />KEY_LID，合盖。<br />注意，可以使用任意多个常数相加获得“或”的关系。例如WaitForKey(KEY_A+KEY_START)意思就是脚本停在这里，等待A键或START键按下才继续运行。<br />这个函数可以用于任何模块。<br /><br />[b]GetStylusPos()[/b]<br />返回触点坐标。<br />例如：local x=-1 local y=-1 x,y=GetStylusPos()<br />这句话的意思就是，定义两个临时变量x和y，并且将触点坐标赋给这两个变量。<br />注意，这个函数会同时返回两个值，所以要用两个变量接收结果。<br />注意，一般情况下这个函数跟随在WaitForKey(KEY_TOUCH)函数之后使用。因为必须等触屏按下，获得的触点坐标才有意义。在触屏没有按下的时候，直接使用这个函数，获得的结果是上次触摸笔离开触屏的那一瞬间触点的坐标。<br />这个函数可以用于任何模块。<br /><br />[b]WaitForThreadDie(线程ID)[/b]<br />等待线程死亡。<br />脚本会停在这个函数处，直到指定的线程死亡。<br />注意，如果在执行这个函数之前，指定的线程已经死亡，则该函数会直接跳跃过去。<br />注意，不要访问“不存在的线程”。这很可能造成线程死锁。<br />这个函数只能用于世界模块。<br /><br />[b]InitData()[/b]<br />初始化数据库。<br />这个函数已经无法解释了。<br />因为，1.05版本以上的引擎（不包括1.05版本），该函数已经被删除。<br />这个函数只能用于世界模块。<br /><br />[b]AddData(数据库ID,类别,图标ID,数据内容字符串,关联脚本名称)[/b]<br />向数据库中添加数据。<br />这个函数已经无法解释了。<br />因为，1.05版本以上的引擎（不包括1.05版本），该函数已经被删除。<br />这个函数只能用于世界模块。<br /><br />[b]DelData(数据库ID)[/b]<br />从数据库中删除指定数据。<br />这个函数已经无法解释了。<br />因为，1.05版本以上的引擎（不包括1.05版本），该函数已经被删除。<br />这个函数只能用于世界模块。<br /><br />[b]UpdateData(数据库ID,类别,图标ID,数据内容字符串,关联脚本名称)[/b]<br />更新指定数据库中的内容。<br />这个函数已经无法解释了。<br />因为，1.05版本以上的引擎（不包括1.05版本），该函数已经被删除。<br />这个函数只能用于世界模块。<br /><br />[b]SelectData()[/b]<br />获得选中的数据库ID。<br />这个函数已经无法解释了。<br />因为，1.05版本以上的引擎（不包括1.05版本），该函数已经被删除。<br />这个函数只能用于世界模块。<br /><br />[b]AddPlayer(角色ID)[/b]<br />角色加入玩家队伍。<br />例如：AddPlayer(0)<br />这句话的意思就是，将角色数据库，也就是character.db中的第0号角色，加入玩家队伍。以后该角色被视为同伴，战斗中会参与我方作战。<br />注意，这个函数只能用4次。因为玩家队伍最多4人。如果想继续加入其它角色，必须删除或者备份已有的角色。<br />注意，这个函数只存在于1.05版本以上的引擎（不包括1.05版本）。<br />这个函数只能用于战斗模块。<br /><br />[b]AddEnemy(角色ID)[/b]<br />角色加入敌方队伍。<br />例如：AddEnemy(0)<br />这句话的意思就是，将角色数据库，也就是character.db中的第0号角色，加入敌方队伍。以后该角色被视为对手，战斗中会参与敌方作战。<br />注意，这个函数只能用4次。因为敌方队伍最多4人。<br />注意，这个函数只存在于1.05版本以上的引擎（不包括1.05版本）。<br />这个函数只能用于战斗模块。<br /><br />[b]PlayBGM(BGM ID,是否循环播放)[/b]<br />播放指定BGM。<br />这个函数没什么值得解释的。<br />注意，不要企图播放soundbank中不存在的BGM。否则必定死机。<br />这个函数可以用于任何模块。<br /><br />[b]PauseBGM()[/b]<br />暂停播放当前的BGM。<br />这个函数没什么值得解释的。<br />注意，如果当前没有播放BGM，自然也就没什么可以暂停的。因此函数相当于直接跳过。<br />注意，由于某些难以解释的原因，不推荐使用这个函数。当然，只是“不推荐”而已，使用了也不会造成什么严重后果。<br />这个函数可以用于任何模块。<br /><br />[b]ResumeBGM()[/b]<br />和上面那个函数是配套的，继续播放被暂停的BGM。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]StopBGM()[/b]<br />停止播放当前的BGM。<br />这个函数没什么值得解释的。<br />注意，如果当前没有播放BGM，自然也就没什么可以暂停的。因此函数相当于直接跳过。<br />这个函数可以用于任何模块。<br /><br />[b]IsPlayingBGM()[/b]<br />返回当前BGM播放器的状态。如果BGM正在播放则返回true，否则返回false。<br />例如：local status=IsPlayingBGM()<br />这句话的意思就是把当前BGM播放器的状态赋给局部变量status。<br />注意，如果BGM处于暂停状态，则返回false。<br />这个函数可以用于任何模块。<br /><br />[b]SetBGMVolume(音量值)[/b]<br />设置BGM音量。<br />注意，音量的范围为0~1024。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SetBGMTempo(速度值)[/b]<br />设置BGM的播放速度。<br />注意，速度的范围为512~2048。512=原速的50%，1024=正常速度，2048=原速的200%。<br />注意，加快速度会导致CPU占用率升高。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SetBGMPitch(音调值)[/b]<br />设置BGM音调。<br />注意，音调的范围为512~2048。512=原调低八度，1024=正常音调，2048=原调高八度。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]PlaySFX(SFX ID)[/b]<br />播放指定的音效并返回该音效的句柄。<br />例如：local sfxHandler=PlaySFX(7)<br />这句话的意思就是，播放第7号音效，同时将该音效的句柄赋给局部变量sfxHandler。<br />注意，不要企图播放soundbank中不存在的音效。否则必定死机。<br />注意，当音效播放完毕之后，句柄自动被废弃。<br />注意，这个函数并不稳定，有一定的几率会出现内存泄露。但是这个函数却又非常重要，所以不得不使用。以后版本的引擎必定会改进这个函数的实现方法。<br />这个函数可以用于任何模块。<br /><br />[b]StopSFX(音效句柄)[/b]<br />停止播放指定的音效。<br />这个函数没什么值得解释的。<br />注意，对于不存在或者已经废弃的句柄，该函数相当于无效。<br />这个函数可以用于任何模块。<br /><br />[b]StopAllSFX()[/b]<br />停止播放所有音效。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SetSFXVolume(音效句柄,音量)[/b]<br />设置指定音效的音量。<br />注意，和BGM不同，音效的音量范围为0~255。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SetSFXPitch(音效句柄,音调)[/b]<br />设置指定音效的音调。<br />同BGM一样，音调范围为512~2048。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SetSFXPanning(音效句柄,音源位置)[/b]<br />设置指定音效的环绕。<br />注意，音源位置参数的范围为0~255。0=左声道，128=双声道，255=右声道。<br />这个函数没什么值得解释的。<br />这个函数可以用于任何模块。<br /><br />[b]SaveGame()[/b]<br />游戏存档。<br />这个函数没什么值得解释的。<br />注意，这个函数不完善。请绝不要轻易使用这个函数。以后版本的引擎必定会将该函数完善。<br />这个函数只能用于世界模块。<br /><br />[b]LoadGame()[/b]<br />游戏读档。<br />这个函数没什么值得解释的。<br />注意，这个函数不完善。请绝不要轻易使用这个函数。以后版本的引擎必定会将该函数完善。<br />这个函数只能用于世界模块。</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>鬼城月</b><br/>
2009-08-17 14:19:41</p>
</div>
<div class="col-10">
<p>真的？？？好消息啊！</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>meng_aq</b><br/>
2009-08-17 15:06:28</p>
</div>
<div class="col-10">
<p>你咋跑这来了</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>meng_aq</b><br/>
2009-08-17 15:08:30</p>
</div>
<div class="col-10">
<p>辛苦楼组了<br />发了不少东东</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>meng_aq</b><br/>
2009-08-17 15:34:26</p>
</div>
<div class="col-10">
<p> 雷叔，厉害啊</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>xxx111zz</b><br/>
2009-08-17 18:34:23</p>
</div>
<div class="col-10">
<p>支持！~~~~~~~~~~~</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>wengypei</b><br/>
2009-08-17 19:24:55</p>
</div>
<div class="col-10">
<p>网名:沛仔<br />性別:男性<br />居住地:广东<br />星座:射手座<br />在做的事:我是学生~~<br />希望：<br />    想学py啦~</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>lhy4tc</b><br/>
2009-08-17 20:25:25</p>
</div>
<div class="col-10">
<p>嘛..丰满了<br />咱喜欢身娇易推倒的-   -</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>yuuhimesama</b><br/>
2009-08-17 21:24:28</p>
</div>
<div class="col-10">
<p>[quote]..抱歉啊T   T身为版主连自己板块不更新不说..连上来看看也没有....<br />看到鼓鼓胸部+1<br />[size=2][color=#999999]lhy4tc 发表于 2009-8-17 20:16[/color] [url=http://www.yayabo.cn/redirect.php?goto=findpost&pid=2802&ptid=938][img]http://www.yayabo.cn/images/common/back.gif[/img][/url][/size][/quote]<br />没事没事，还有我呢。。。</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>忧郁de宝宝</b><br/>
2010-08-05 09:01:21</p>
</div>
<div class="col-10">
<p>偶突然觉得鸭梨很大</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>a4381782</b><br/>
2010-08-05 09:01:47</p>
</div>
<div class="col-10">
<p>呵呵  狂发水帖没意义的</p>
</div>
</div>

<hr class="my-4" />
<div class="row">
<div class="col-2">
<p><b>a4381782</b><br/>
2010-08-05 09:04:03</p>
</div>
<div class="col-10">
<p>蛮可爱的吗？</p>
</div>
</div>


            
            <div class="row">
                <nav aria-label="Page navigation example">
                    <ul class="pagination justify-content-center">
                    <!--<li class="page-item disabled">
                        <a class="page-link">Previous</a>
                    </li>
                    <li class="page-item"><a class="page-link" href="#">1</a></li>
                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                    <li class="page-item">
                        <a class="page-link" href="#">Next</a>
                    </li>
                        -->
                        <li class="page-item active">
<a class="page-link" href="post16514_1.html">1</a>
</li>


                    </ul>
                </nav>
            </div>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    </body>
</html>

